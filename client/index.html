<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Artists - YTMusic</title>

    {{meta}}{{tabler}}
  </head>
  <body>
    {{navbar}}

    <div class="page-body container-fluid text-center">
      <h1>Artists</h1>
      <div class="input-icon mt-3 mb-2">
        <span class="input-icon-addon ti ti-search"></span>
        <input type="text" class="form-control" placeholder="Search by Name" id="name-input" />
      </div>
      <div id="artists" class="row row-cards" data-masonry='{"percentPosition": true }'></div>
    </div>

    <script>
      let artists = document.getElementById("artists");

      function openArtist(a) {
        let old = document.getElementById("artist-modal");
        if (old) old.remove();

        let modal = document.createElement("span");
        modal.id = "artist-modal";
        modal.innerHTML = `{{artist-open}}`;
        let styles = {position: "absolute", width: "100%", top: "0px", left: "0px", height: "100%", backgroundColor: "rgba(0,0,0,0.5)"}
        Object.keys(styles).forEach(s => {
          modal.style[s] = styles[s];
        });
        let color = Theme.current == "dark" ? "000000" : "ffffff";
        modal.querySelector(".btn-close").style.background = `transparent url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23${color}'%3e%3cpath d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/%3e%3c/svg%3e") center/.75rem auto no-repeattransparent url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23${color}'%3e%3cpath d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/%3e%3c/svg%3e") center/.75rem auto no-repeat`
        document.body.appendChild(modal);
      }

      fetch(`/api/artists/all`)
        .then((res) => res.json())
        .then(async (res) => {
          if (res.err) return;

          let artists = document.getElementById("artists");
          artists.innerHTML = "";
          res
            .sort((a, b) => {
              return a.name.toLowerCase().replace(/the /i, "") >
                b.name.toLowerCase().replace(/the /i, "")
                ? 1
                : -1;
            })
            .forEach((a) => {
              let artist = document.createElement("div");
              artist.innerHTML = `{{artist-card}}`;
              artist.classList.add("col-sm-6", "col-lg-4");
              artist.onclick = function () {
                openArtist(a);
              };
              artists.appendChild(artist);
              let hover = document.getElementById(`card-overlay-${a.id}`).querySelector("span");
              hover.className = "ti ti-settings text-indigo";
              hover.style.textShadow = "none";
            });
        })
        .catch((err) => {
          console.log("Server is down? Error: " + err);
        });
    </script>
  </body>
</html>
